<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UC - Ghi danh khóa học</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f5f5f5;
        }

        .header {
            background: #fff;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #e0e0e0;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .back-btn {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #666;
        }

        .header-title {
            font-size: 14px;
            color: #666;
            font-weight: 400;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .icon-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #ffccbc;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: #ff5722;
        }

        .username {
            font-size: 14px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 30px;
            font-size: 14px;
            color: #666;
        }

        .breadcrumb a {
            color: #666;
            text-decoration: none;
        }

        .section-header {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            text-align: center;
        }

        .search-filter {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .search-input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .filter-btn {
            padding: 10px 20px;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .course-label {
            font-size: 13px;
            font-weight: 500;
            color: #666;
            margin-bottom: 15px;
        }

        .course-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .course-card {
            background: #fff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .course-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .course-image {
            width: 100%;
            aspect-ratio: 3/4;
            object-fit: cover;
        }

        .course-info {
            padding: 12px;
        }

        .course-title {
            font-size: 13px;
            font-weight: 500;
            color: #333;
            margin-bottom: 4px;
        }

        .course-code {
            font-size: 11px;
            color: #999;
            margin-bottom: 8px;
        }

        .course-price {
            font-size: 14px;
            font-weight: 600;
            color: #ff5722;
        }

        .see-more {
            text-align: right;
            margin-top: 15px;
        }

        .see-more a {
            color: #2196f3;
            text-decoration: none;
            font-size: 14px;
        }

        .fab-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, #00d4aa 0%, #00b894 100%);
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 212, 170, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            z-index: 1000;
        }

        .fab-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 16px rgba(0, 212, 170, 0.5);
        }

        .popup-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            z-index: 9998;
            animation: fadeIn 0.3s;
        }

        .popup-overlay.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .filter-popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 16px;
            width: 90%;
            max-width: 450px;
            z-index: 9999;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.3s;
        }

        .filter-popup.active {
            display: block;
        }

        @keyframes slideUp {
            from {
                transform: translate(-50%, -40%);
                opacity: 0;
            }
            to {
                transform: translate(-50%, -50%);
                opacity: 1;
            }
        }

        .popup-header {
            padding: 24px 24px 20px;
            border-bottom: 1px solid #e0e0e0;
            text-align: center;
        }

        .popup-header h3 {
            font-size: 20px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .popup-header p {
            font-size: 14px;
            color: #666;
        }

        .popup-body {
            padding: 24px;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-group label {
            display: block;
            font-size: 15px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 14px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            background: #fff;
        }

        .radio-option:hover {
            border-color: #00d4aa;
            background: #f0fff9;
        }

        .radio-option input[type="radio"] {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            cursor: pointer;
            accent-color: #00d4aa;
        }

        .radio-option label {
            font-size: 14px;
            color: #333;
            margin: 0;
            cursor: pointer;
            flex: 1;
        }

        .radio-option.selected {
            border-color: #00d4aa;
            background: #f0fff9;
        }

        .submit-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #00d4aa 0%, #00b894 100%);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 8px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 212, 170, 0.4);
        }

        .content-blurred {
            filter: blur(8px);
            pointer-events: none;
        }

        /* UC 3.3 - Course Detail */
        .course-detail {
            background: #fff;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .course-detail-header {
            display: flex;
            gap: 20px;
            margin-bottom: 24px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
        }

        .course-detail-image {
            width: 120px;
            height: 160px;
            border-radius: 8px;
            object-fit: cover;
        }

        .course-detail-info h2 {
            font-size: 20px;
            color: #333;
            margin-bottom: 8px;
        }

        .course-detail-info p {
            font-size: 14px;
            color: #666;
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .course-detail-price {
            font-size: 24px;
            font-weight: 700;
            color: #ff5722;
        }

        .course-detail-content {
            font-size: 14px;
            color: #333;
            line-height: 1.8;
        }

        .course-detail-content p {
            margin-bottom: 12px;
        }

        .enroll-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #2196f3 0%, #1976d2 100%);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
        }

        .enroll-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(33, 150, 243, 0.4);
        }

        /* UC 3.4 - Schedule Selection */
        .schedule-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .schedule-item {
            background: #fff;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s;
        }

        .schedule-item:hover {
            border-color: #2196f3;
            background: #f0f7ff;
        }

        .schedule-info {
            flex: 1;
        }

        .schedule-name {
            font-size: 15px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }

        .schedule-time {
            font-size: 13px;
            color: #666;
            margin-bottom: 6px;
        }

        .schedule-seats {
            font-size: 12px;
            color: #999;
        }

        .select-schedule-btn {
            padding: 10px 24px;
            background: linear-gradient(135deg, #2196f3 0%, #1976d2 100%);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .select-schedule-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.4);
        }

        /* UC 3.5 - Student Info Form */
        .student-form {
            background: #fff;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .form-field {
            margin-bottom: 20px;
        }

        .form-field label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .form-field input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s;
        }

        .form-field input:focus {
            outline: none;
            border-color: #2196f3;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }

        .selected-schedule-box {
            background: #f0f7ff;
            border: 2px solid #2196f3;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 24px;
        }

        .selected-schedule-box h4 {
            font-size: 15px;
            color: #333;
            margin-bottom: 8px;
        }

        .selected-schedule-box p {
            font-size: 13px;
            color: #666;
            margin-bottom: 4px;
        }

        .payment-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 24px;
        }

        .payment-option {
            display: flex;
            align-items: center;
            padding: 14px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .payment-option:hover {
            border-color: #2196f3;
            background: #f0f7ff;
        }

        .payment-option input[type="radio"] {
            width: 18px;
            height: 18px;
            margin-right: 12px;
            accent-color: #2196f3;
        }

        .payment-option.selected {
            border-color: #2196f3;
            background: #f0f7ff;
        }

        .confirm-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #00d4aa 0%, #00b894 100%);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .confirm-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 212, 170, 0.4);
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Popup Overlay -->
    <div class="popup-overlay active" id="popupOverlay"></div>

    <!-- Filter Popup (UC 3.1) -->
    <div class="filter-popup active" id="filterPopup">
        <div class="popup-header">
            <h3>Tìm khóa học phù hợp</h3>
            <p>Chọn trình độ và mục tiêu của bạn</p>
        </div>
        <div class="popup-body">
            <form id="filterForm">
                <div class="form-group">
                    <label>Trình độ hiện tại của bạn</label>
                    <div class="radio-group">
                        <div class="radio-option" onclick="selectRadio(this, 'level')">
                            <input type="radio" name="level" value="beginner" id="beginner">
                            <label for="beginner">Mới bắt đầu (Beginner)</label>
                        </div>
                        <div class="radio-option" onclick="selectRadio(this, 'level')">
                            <input type="radio" name="level" value="intermediate" id="intermediate">
                            <label for="intermediate">Trung cấp (Intermediate)</label>
                        </div>
                        <div class="radio-option" onclick="selectRadio(this, 'level')">
                            <input type="radio" name="level" value="advanced" id="advanced">
                            <label for="advanced">Nâng cao (Advanced)</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Mục tiêu học tập</label>
                    <div class="radio-group">
                        <div class="radio-option" onclick="selectRadio(this, 'goal')">
                            <input type="radio" name="goal" value="ielts" id="ielts">
                            <label for="ielts">Luyện thi IELTS</label>
                        </div>
                        <div class="radio-option" onclick="selectRadio(this, 'goal')">
                            <input type="radio" name="goal" value="toeic" id="toeic">
                            <label for="toeic">Luyện thi TOEIC</label>
                        </div>
                        <div class="radio-option" onclick="selectRadio(this, 'goal')">
                            <input type="radio" name="goal" value="communication" id="communication">
                            <label for="communication">Giao tiếp hàng ngày</label>
                        </div>
                        <div class="radio-option" onclick="selectRadio(this, 'goal')">
                            <input type="radio" name="goal" value="programming" id="programming">
                            <label for="programming">Lập trình & IT</label>
                        </div>
                    </div>
                </div>

                <button type="submit" class="submit-btn">Xem khóa học phù hợp</button>
            </form>
        </div>
    </div>

    <!-- Main Content -->
    <div id="mainContent" class="content-blurred">
        <div class="header">
            <div class="header-left">
                <button class="back-btn" onclick="goBack()">‹</button>
                <span class="header-title" id="headerTitle">UC 3.1 Ghi danh khóa học</span>
            </div>
            <div class="header-right">
                <button class="icon-btn">🔔</button>
                <button class="icon-btn">🔍</button>
                <button class="icon-btn">⋮</button>
                <div class="user-info">
                    <div class="avatar">H</div>
                    <span class="username">Huy Hiền</span>
                </div>
            </div>
        </div>

        <!-- UC 3.2 - Course List -->
        <div class="page active" id="page32">
            <div class="container">
                <div class="breadcrumb">
                    <a href="#">← Home</a>
                </div>

                <div class="section-header">
                    <h2 class="section-title">DANH SÁCH KHÓA HỌC</h2>
                    <div class="search-filter">
                        <input type="text" class="search-input" placeholder="Nhập tìm kiếm...">
                        <button class="filter-btn" onclick="openFilterPopup()">Lọc ▼</button>
                    </div>
                </div>

                <div class="course-label">HỌC LỘNG TRÌNH TẠI</div>

                <div class="course-grid" id="courseGrid"></div>

                <div class="see-more">
                    <a href="#">Xem thêm →</a>
                </div>
            </div>
        </div>

        <!-- UC 3.3 - Course Detail -->
        <div class="page" id="page33">
            <div class="container">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('page32'); return false;">← Quay lại danh sách</a>
                </div>

                <div class="section-header">
                    <h2 class="section-title">THÔNG TIN KHÓA HỌC</h2>
                </div>

                <div class="course-detail">
                    <div class="course-detail-header">
                        <img id="detailImage" class="course-detail-image" alt="Course">
                        <div class="course-detail-info">
                            <h2 id="detailName">IELTS 18</h2>
                            <p id="detailCode">Mã khóa học: IELTS18</p>
                            <div class="course-detail-price" id="detailPrice">2.500.000đ</div>
                        </div>
                    </div>
                    <div class="course-detail-content">
                        <p><strong>Mô tả khóa học:</strong></p>
                        <p>Khóa học IELTS 18 được thiết kế dành cho học viên muốn đạt điểm cao trong kỳ thi IELTS. Chương trình học bài bản, có cấu trúc rõ ràng với đội ngũ giảng viên giàu kinh nghiệm.</p>
                        <p><strong>Nội dung học:</strong> Listening, Reading, Writing, Speaking với các bài test thực chiến, chiến lược làm bài hiệu quả.</p>
                        <p><strong>Thời lượng:</strong> 3 tháng (36 buổi học)</p>
                        <p><strong>Đối tượng:</strong> Học viên có trình độ từ Intermediate trở lên</p>
                    </div>
                    <button class="enroll-btn" onclick="showPage('page34')">Đăng ký ngay</button>
                </div>
            </div>
        </div>

        <!-- UC 3.4 - Schedule Selection -->
        <div class="page" id="page34">
            <div class="container">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('page33'); return false;">← Quay lại</a>
                </div>

                <div class="section-header">
                    <h2 class="section-title">DANH SÁCH CÁC LỚP HỌC - LỊCH HỌC CÓ ĐĂNG KÝ</h2>
                </div>

                <div class="schedule-list">
                    <div class="schedule-item">
                        <div class="schedule-info">
                            <div class="schedule-name">Lớp A1 - Sáng</div>
                            <div class="schedule-time">T2, T4, T6: 08h00 - 10h00</div>
                            <div class="schedule-seats">Còn trống: 5/25 chỗ</div>
                        </div>
                        <button class="select-schedule-btn" onclick="selectSchedule('Lớp A1 - Sáng', 'T2, T4, T6: 08h00 - 10h00')">Chọn</button>
                    </div>

                    <div class="schedule-item">
                        <div class="schedule-info">
                            <div class="schedule-name">Lớp A2 - Chiều</div>
                            <div class="schedule-time">T2, T4, T6: 14h00 - 16h00</div>
                            <div class="schedule-seats">Còn trống: 8/25 chỗ</div>
                        </div>
                        <button class="select-schedule-btn" onclick="selectSchedule('Lớp A2 - Chiều', 'T2, T4, T6: 14h00 - 16h00')">Chọn</button>
                    </div>

                    <div class="schedule-item">
                        <div class="schedule-info">
                            <div class="schedule-name">Lớp B1 - Tối</div>
                            <div class="schedule-time">T3, T5, T7: 18h00 - 20h00</div>
                            <div class="schedule-seats">Còn trống: 3/25 chỗ</div>
                        </div>
                        <button class="select-schedule-btn" onclick="selectSchedule('Lớp B1 - Tối', 'T3, T5, T7: 18h00 - 20h00')">Chọn</button>
                    </div>

                    <div class="schedule-item">
                        <div class="schedule-info">
                            <div class="schedule-name">Lớp B2 - Cuối tuần</div>
                            <div class="schedule-time">T7, CN: 09h00 - 12h00</div>
                            <div class="schedule-seats">Còn trống: 12/25 chỗ</div>
                        </div>
                        <button class="select-schedule-btn" onclick="selectSchedule('Lớp B2 - Cuối tuần', 'T7, CN: 09h00 - 12h00')">Chọn</button>
                    </div>

                    <div class="schedule-item">
                        <div class="schedule-info">
                            <div class="schedule-name">Lớp C1 - Online</div>
                            <div class="schedule-time">T2, T4, T6: 20h00 - 22h00</div>
                            <div class="schedule-seats">Còn trống: 15/30 chỗ</div>
                        </div>
                        <button class="select-schedule-btn" onclick="selectSchedule('Lớp C1 - Online', 'T2, T4, T6: 20h00 - 22h00')">Chọn</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- UC 3.5 - Student Info Form -->
        <div class="page" id="page35">
            <div class="container">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('page34'); return false;">← Quay lại</a>
                </div>

                <div class="section-header">
                    <h2 class="section-title">DANH SÁCH CÁC LỚP HỌC - LỚP HỌC CỤ THỂ ĐĂNG KÝ</h2>
                </div>

                <div class="student-form">
                    <div class="selected-schedule-box">
                        <h4>Lớp học đã chọn</h4>
                        <p id="selectedScheduleName">Lớp A1 - Sáng</p>
                        <p id="selectedScheduleTime">T2, T4, T6: 08h00 - 10h00</p>
                    </div>

                    <h3 style="font-size: 16px; margin-bottom: 16px; color: #333;">THÔNG TIN ĐĂNG KÝ</h3>

                    <form id="studentForm">
                        <div class="form-field">
                            <label>Họ và tên</label>
                            <input type="text" placeholder="Nguyễn Văn A" required>
                        </div>

                        <div class="form-field">
                            <label>Mã sinh viên</label>
                            <input type="text" placeholder="SV2024001" required>
                        </div>

                        <div class="form-field">
                            <label>Email</label>
                            <input type="email" placeholder="email@example.com" required>
                        </div>

                        <div class="form-field">
                            <label>Số điện thoại</label>
                            <input type="tel" placeholder="0912345678" required>
                        </div>

                        <h3 style="font-size: 16px; margin: 24px 0 16px; color: #333;">PHƯƠNG THỨC THANH TOÁN</h3>

                        <div class="payment-options">
                            <div class="payment-option" onclick="selectPayment(this)">
                                <input type="radio" name="payment" value="bank" id="bank">
                                <label for="bank">Chuyển khoản ngân hàng</label>
                            </div>
                            <div class="payment-option" onclick="selectPayment(this)">
                                <input type="radio" name="payment" value="cash" id="cash">
                                <label for="cash">Thanh toán tại trường</label>
                            </div>
                            <div class="payment-option" onclick="selectPayment(this)">
                                <input type="radio" name="payment" value="momo" id="momo">
                                <label for="momo">Ví điện tử MoMo</label>
                            </div>
                        </div>

                        <button type="submit" class="confirm-btn">Xác nhận đăng ký</button>
                    </form>
                </div>
            </div>
        </div>

        <button class="fab-btn">💬</button>
    </div>

    <script>
        let currentCourse = null;

        // Course data
        const courses = {
            ielts: [
                { name: 'IELTS 18', code: 'IELTS18', price: '2.500.000đ', color: '#e53935', text: 'IELTS', number: '18' },
                { name: 'IELTS 20', code: 'IELTS20', price: '2.500.000đ', color: '#e53935', text: 'IELTS', number: '20' }
            ],
            toeic: [
                { name: 'First Certificate', code: 'FCE01', price: '2.800.000đ', color: '#212121', text: 'FIRST', text2: 'CERTIFICATE' },
                { name: 'Preliminary', code: 'PREL01', price: '2.000.000đ', color: '#424242', text: 'PRELIMINARY' }
            ],
            communication: [
                { name: 'Sneak Peek Plus', code: 'SPP01', price: '1.800.000đ', color: '#00bcd4', text: 'SNEAK', text2: 'PEEK', text3: 'Plus' }
            ],
            programming: [
                { name: 'JavaScript', code: 'JS101', price: '3.200.000đ', color: '#424242', text: 'JAVASCRIPT', text2: 'Advanced' }
            ]
        };

        function selectRadio(element, groupName) {
            const radioOptions = element.parentElement.querySelectorAll('.radio-option');
            radioOptions.forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
            element.querySelector('input[type="radio"]').checked = true;
        }

        function selectPayment(element) {
            const paymentOptions = element.parentElement.querySelectorAll('.payment-option');
            paymentOptions.forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
            element.querySelector('input[type="radio"]').checked = true;
        }

        function closeFilterPopup() {
            document.getElementById('popupOverlay').classList.remove('active');
            document.getElementById('filterPopup').classList.remove('active');
            document.getElementById('mainContent').classList.remove('content-blurred');
        }

        function openFilterPopup() {
            document.getElementById('popupOverlay').classList.add('active');
            document.getElementById('filterPopup').classList.add('active');
            document.getElementById('mainContent').classList.add('content-blurred');
        }

        function generateCourseImage(course) {
            let svg = `<svg xmlns='http://www.w3.org/2000/svg' width='160' height='213'>
                <rect fill='${course.color}' width='160' height='213'/>`;
            
            if (course.number) {
                svg += `<text x='50%' y='40%' font-size='32' fill='white' text-anchor='middle' font-family='Arial, sans-serif' font-weight='bold'>${course.text}</text>
                        <text x='50%' y='60%' font-size='48' fill='white' text-anchor='middle' font-family='Arial, sans-serif' font-weight='bold'>${course.number}</text>`;
            } else if (course.text2) {
                const y1 = course.text3 ? '30%' : '35%';
                const y2 = course.text3 ? '50%' : '60%';
                svg += `<text x='50%' y='${y1}' font-size='${course.text.length > 10 ? '20' : '32'}' fill='white' text-anchor='middle' font-family='Arial, sans-serif' font-weight='bold'>${course.text}</text>
                        <text x='50%' y='${y2}' font-size='${course.text2.length > 10 ? '18' : '20'}' fill='${course.text3 ? '#ffd700' : 'white'}' text-anchor='middle' font-family='Arial, sans-serif' font-weight='bold'>${course.text2}</text>`;
                if (course.text3) {
                    svg += `<text x='50%' y='70%' font-size='16' fill='white' text-anchor='middle' font-family='Arial, sans-serif'>${course.text3}</text>`;
                }
            } else {
                svg += `<text x='50%' y='40%' font-size='28' fill='white' text-anchor='middle' font-family='Arial, sans-serif' font-weight='bold'>${course.text}</text>`;
            }
            
            svg += '</svg>';
            return 'data:image/svg+xml,' + encodeURIComponent(svg);
        }

        function loadCourses(goal) {
            const courseGrid = document.getElementById('courseGrid');
            courseGrid.innerHTML = '';
            
            const selectedCourses = courses[goal] || [];
            
            selectedCourses.forEach(course => {
                const courseCard = document.createElement('div');
                courseCard.className = 'course-card';
                courseCard.onclick = () => showCourseDetail(course);
                courseCard.innerHTML = `
                    <img src="${generateCourseImage(course)}" alt="${course.name}" class="course-image">
                    <div class="course-info">
                        <div class="course-title">${course.name}</div>
                        <div class="course-code">Mã: ${course.code}</div>
                        <div class="course-price">${course.price}</div>
                    </div>
                `;
                courseGrid.appendChild(courseCard);
            });

            if (selectedCourses.length === 0) {
                Object.values(courses).flat().slice(0, 4).forEach(course => {
                    const courseCard = document.createElement('div');
                    courseCard.className = 'course-card';
                    courseCard.onclick = () => showCourseDetail(course);
                    courseCard.innerHTML = `
                        <img src="${generateCourseImage(course)}" alt="${course.name}" class="course-image">
                        <div class="course-info">
                            <div class="course-title">${course.name}</div>
                            <div class="course-code">Mã: ${course.code}</div>
                            <div class="course-price">${course.price}</div>
                        </div>
                    `;
                    courseGrid.appendChild(courseCard);
                });
            }
        }

        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            
            const titles = {
                'page32': 'UC 3.2 Ghi danh khóa học',
                'page33': 'UC 3.3 Ghi danh khóa học',
                'page34': 'UC 3.4 Ghi danh khóa học',
                'page35': 'UC 3.5 Ghi danh khóa học'
            };
            document.getElementById('headerTitle').textContent = titles[pageId] || 'UC Ghi danh khóa học';
        }

        function showCourseDetail(course) {
            currentCourse = course;
            document.getElementById('detailImage').src = generateCourseImage(course);
            document.getElementById('detailName').textContent = course.name;
            document.getElementById('detailCode').textContent = 'Mã khóa học: ' + course.code;
            document.getElementById('detailPrice').textContent = course.price;
            showPage('page33');
        }

        function selectSchedule(name, time) {
            document.getElementById('selectedScheduleName').textContent = name;
            document.getElementById('selectedScheduleTime').textContent = time;
            showPage('page35');
        }

        function goBack() {
            const currentPage = document.querySelector('.page.active');
            if (currentPage.id === 'page35') {
                showPage('page34');
            } else if (currentPage.id === 'page34') {
                showPage('page33');
            } else if (currentPage.id === 'page33') {
                showPage('page32');
            }
        }

        // Handle filter form submission
        document.getElementById('filterForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const level = document.querySelector('input[name="level"]:checked');
            const goal = document.querySelector('input[name="goal"]:checked');
            
            if (!level || !goal) {
                alert('Vui lòng chọn đầy đủ thông tin!');
                return;
            }

            loadCourses(goal.value);
            closeFilterPopup();
            showPage('page32');
        });

        // Handle student form submission
        document.getElementById('studentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const payment = document.querySelector('input[name="payment"]:checked');
            if (!payment) {
                alert('Vui lòng chọn phương thức thanh toán!');
                return;
            }

            alert('Đăng ký thành công!\n\nThông tin đăng ký của bạn đã được ghi nhận.\nVui lòng kiểm tra email để xác nhận.');
            
            // Reset and go back to course list
            this.reset();
            showPage('page32');
        });
    </script>
</body>
</html>